<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
	<title>塔防遊戲</title>
</head>
<body>

<!--style-->
<style>
</style>

<div id = "image_box" style="display:none">
    <!--back_ground-->
	<img src="pic/image_back_ground.png" id = "image_back_ground"/>
	<!--塔-->
    <img src="pic/image_arrow_tower.png" id = "image_arrow_tower"/>
    <img src="pic/image_turret_tower.png" id = "image_turret_tower"/>
    <img src="pic/image_ice_tower.png" id = "image_ice_tower"/>
    <img src="pic/image_up_tower.png" id = "image_up_tower"/>
    <!--enemy-->
	<img src="pic/image_enemy_01.png" id = "image_enemy_01"/>
    <img src="pic/image_enemy_02.png" id = "image_enemy_02"/>
</div>

<!--遊戲區塊-->
<div style="width:1024px; margin: 0 auto; border: 3px solid black">
    <div id="status_box" style="width:1024px; height:64px;">
        <canvas id="status_area" width="1024" height="64"></canvas>
    </div>
    <div id="play_box" style="width:1024px; height:512px;">  <!--多層canvas-->
        <canvas id="menu_area" width="1024" height="512" style="position: absolute; z-index: 3"></canvas>
        <canvas id="play_area" width="1024" height="512" style="position: absolute; z-index: 2"></canvas>
        <canvas id="back_ground" width="1024" height="512" style="position: absolute; z-index: 1"></canvas>
    </div>
</div>

<!--載入需要的js-->
<script type="text/javascript" src ="variable.js"></script>
<script type="text/javascript" src ="map_data.js"></script>
<script type="text/javascript" src ="tower.js"></script>
<script type="text/javascript" src ="enemy.js"></script>
<script type="text/javascript" src ="map_build.js"></script>

<script type="text/javascript">
//載入時的動畫 var
var load; 
var load_word = 'LOADING';

//載入時間 =>讓資料有充分的時間載入
load_time();

//載入完成
function game_start () {
    //loading 完成
    clearInterval(load);
    
    menu_area.clearRect(0, 0, menu_area_w, menu_area_h);
    status_area.clearRect(0, 0, status_area_w, status_area_h);
    
    draw_back_ground();
	status_update ();
    
    var play_game = setInterval(drawCanvas,40);
    
    function drawCanvas() {      
        draw_enemy();
        //清除
        play_area.clearRect(0, 0, play_area_w, play_area_h);
        
        for (var key in enemies) {
            enemies[key].working();
        }
    }
}
//載入時間
function load_time() {
    //loding .....
    load_text();
    load = setInterval(load_text,500);
	
    status_area.fillStyle='rgba(209,209,209,0.7)';
    status_area.fillRect(0,0,status_area_w,status_area_h);

    setTimeout(game_start,1000);
}
//載入時的動畫 load...
function load_text() {
    menu_area.clearRect(0, 0, menu_area_w, menu_area_h);
    
    menu_area.fillStyle='rgba(209,209,209,0.7)'; 
    menu_area.fillRect(0,0,menu_area_w,menu_area_h);
    
    menu_area.fillStyle = "black";
    menu_area.font = '72px 微軟正黑體';
    menu_area.fillText(load_word,8*unit, 8*unit);
    load_word = load_word+".";
}
//狀態欄位更新
function status_update () {
	var status_y = unit*2+unit/2;
	var text_style = "bold 18px 微軟正黑體";
	var status_tower = [];
	
	status_area.fillStyle='#d0d0d0';
    status_area.fillRect(0,0,status_area_w,status_area_h); 
	
	//開始按鈕
	status_area.fillStyle='#EA0000';
    status_area.fillRect(unit,unit,unit*5,unit*2); 
	status_area.fillStyle='#000000';
	status_area.font = text_style;
    status_area.fillText("遊戲開始",unit+unit/3, status_y); 
	
	//目前波數/總波數
	status_area.fillStyle='#000000';
	status_area.font = text_style;
    status_area.fillText("目前波數:"+(enemy_batch+1)+"/總波數:"+this[map_no]["enemy"].length,unit*8, status_y);

	//生命
	status_area.fillStyle='#000000';
	status_area.font = text_style;
    status_area.fillText("生命:"+my_hp,unit*20, status_y);
	
	//金錢
	status_area.fillStyle='#000000';
	status_area.font = text_style;
    status_area.fillText("金錢:"+my_money,unit*25, status_y);
	
	//砲塔 4
	status_tower[0] = new Arrow_tower(33, 0, status_area);
	status_tower[1] = new Turret_tower(40, 0, status_area);
	status_tower[2] = new Ice_tower(47, 0, status_area);
	status_tower[3] = new Up_tower(54, 0, status_area);
	
	for (var key in status_tower) {
		status_tower[key].draw();

		status_area.font = text_style;
		status_area.fillText(status_tower[key].name,(status_tower[key].x+2)*unit,unit);
		status_area.fillText(status_tower[key].cost_money,(status_tower[key].x+2)*unit,status_y);

	}
	
}
</script>

</body>
</html>